# デプロイエラーチェックと自動修正ガイド

## 現在のdeploy.ymlの状態

現在の`.github/workflows/deploy.yml`は正しいYAML構文を使用しています：
- `printf`コマンドを使用（here-documentの問題なし）
- 適切なインデント
- 正しいYAML構文

## エラーの原因と対策

### エラー1: YAML構文エラー（line 92, 98, 116）

**原因：**
- here-document（`<< 'SPAEOF'`）が正しく閉じられていない
- YAMLのインデントが不正

**対策：**
現在のファイルは`printf`コマンドを使用しているため、この問題は発生しません。

### エラー2: here-documentの終端マーカーが見つからない

**原因：**
- `cat > file << 'SPAEOF'`の形式で、終端マーカー（`SPAEOF`）が正しく配置されていない

**対策：**
現在のファイルは`printf`コマンドを使用しているため、この問題は発生しません。

## デプロイ確認手順

### 1. GitHub Actionsの確認

以下のURLでワークフローの実行状況を確認：
https://github.com/octdoors-byte/engraving-simulator/actions

### 2. デプロイURLの確認

以下のURLでサイトが正常にアクセスできるか確認：
https://octdoors-byte.github.io/engraving-simulator/

### 3. エラーが発生した場合

1. **GitHub Actionsのログを確認**
   - Actionsタブで最新のワークフロー実行を開く
   - エラーメッセージを確認

2. **YAML構文の確認**
   - `.github/workflows/deploy.yml`の構文を確認
   - インデントが正しいか確認
   - here-documentが正しく閉じられているか確認

3. **再デプロイ**
   - エラーを修正後、再度コミット・プッシュ
   - または、GitHub Actionsの「Re-run jobs」を使用

## 自動チェック機能

以下のスクリプトでデプロイ状況を自動確認できます：

```powershell
.\デプロイ確認スクリプト.ps1
```

このスクリプトは：
- デプロイURLへのアクセスを確認
- 最大5分間、10秒ごとに確認
- 成功時に通知

## 今後の対策

1. **YAML構文の事前チェック**
   - コミット前にYAML構文を確認
   - here-documentの代わりに`printf`を使用（現在実装済み）

2. **デプロイ自動確認**
   - プッシュ後に自動的にデプロイ状況を確認
   - エラー時に通知

3. **エラーハンドリングの強化**
   - デプロイ失敗時の自動リトライ
   - 詳細なエラーログの出力
