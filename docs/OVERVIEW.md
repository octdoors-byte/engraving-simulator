## 名入れ刻印シミュレーター ミーティング報告書（完全版）

### 0. 現状のざっくりまとめ（いま何ができるか）

本ツールは、名入れ・刻印に必要なロゴ配置をブラウザ上で作成し、配置結果を「デザインID」として確定・共有できるツールです。  
目的はPDF発行そのものではなく、ロゴの位置・大きさ等の配置デザインをデザインIDとして発行し、注文時にそのIDを共有することで、刻印工程の検索・再現・確認を短縮することにあります。

- **運用担当者**は、基本設定やテンプレートの登録・管理、公開URLの発行、発行履歴（デザインID含む）の検索・確認、バックアップ／復元を行えます。
- **お客様**は、公開URLからデザインを作成し、デザインIDを発行して注文時に貼り付ける運用です。

データ保存については、現時点ではブラウザ内（localStorage / IndexedDB）への保存でテストを行っており、  
本番運用に向けてサーバー側（HP）の保存先設定を進めています。

#### 0-0. このツールが解消すること（要点）

- **運用担当者（管理）**
  - 確認作業の時間短縮（注文で受け取ったデザインIDから履歴を検索し、同じ配置をすぐ再現できる）
  - やり取り・手戻りの削減（「位置が違う／もう一度送って」などの往復が減る）
  - 作業の標準化（担当者が変わっても同じ基準で確認・刻印できる）

- **お客様**
  - 説明の手間を削減（言葉で位置を説明せず、デザインIDで伝えられる）
  - 確認待ちの時間短縮（意図が一回で伝わりやすくなる）
  - 認識違いの防止（「この位置のつもり」がズレにくい）

#### 0-1. 運用担当者ができること

- 基本設定（ロゴ・見出し・共通説明・カテゴリ色など）を登録・変更できる
- テンプレート（JSON＋背景画像）を登録し、下書き→テスト→公開まで状態管理できる
- 公開用URLを発行し、お客様に共有できる
- 発行履歴を検索・確認・削除できる（履歴にはデザインIDが含まれる）
- バックアップ／復元ができる

#### 0-2. お客様ができること

- 運用担当者から渡された公開URLを開き、ロゴ配置（位置・大きさ）を作成できる
- デザインIDを発行できる
- 確認用PDFを発行し、ダウンロードできる（※現状は確認用PDFのみ）

---

### 0-3. 最終的に実現したいこと（ゴールのイメージ）

- **迷わず・安心して使える名入れシミュレーターにする**
  - テンプレ登録〜ロゴ配置〜デザインID発行〜発行履歴検索〜刻印作業までを安定運用できる。
  - トラブル時も、バックアップ／復元しながら継続利用できる。

- **外注先にも渡せる共通ツールにする**
  - 役割がガイドとUIで明確。
  - ロゴ・カラー・文言は案件ごとに基本設定で切り替えられる。
  - 必要に応じてパスワードや保存ルールを決め、安全に開放できる。

- **クライアントごとに“ブランド合わせ”したパッケージとして展開できる土台にする**
  - 仕組みは共通で、見た目と文言だけ短時間で各社仕様にできる。
  - 将来的にテーマ／プリセットとして切り替えやすくする。

- **出力の役割分担を整理し、PDFとAIを使い分ける前提を持つ**
  - ツールはまず「配置の確定（デザインID）」を核にする。
  - AIが必要な案件は、外部デザイナー側（Illustrator作業等）で対応する線引きを前提にする。

---

### 1. 用語定義（重要）

- **デザインID**
  - お客様が発行するID。
  - ロゴの位置・大きさ等の配置設定が紐づいた「デザインの番号」。
  - 注文時にこのIDを共有することで、運用担当者が発行履歴から該当デザインを検索し、同一配置で刻印できる。

- **確認用PDF（現状）**
  - 出力は確認用PDFのみ。
  - お客様が作成した配置を確認するためのPDFとして扱う。

- **テンプレート**
  - `template.json` と背景画像（必要に応じて刻印範囲やキャンバス情報を含む）で構成される。
  - お客様はテンプレートを選ぶのではなく、共有された公開URLから利用する。

---

### 2. 成功条件（必要なこと／品質条件）

#### 2-1. 一致・再現性

- **デザインが一致すること**
  - お客様が作成した配置が、運用担当者側でデザインID検索しても同一で再現できること。

- **大きさが変わらないこと**
  - デザインIDから再現したときにロゴサイズが意図せず変化しないこと。

#### 2-2. 一意性・検索性

- **デザインIDが重複しないこと**
  - 異なるデザインに同じIDが割り当てられないこと。

- **デザインIDから発行履歴を検索できること**
  - 受領したIDで、該当デザインを確実に特定できること。

#### 2-3. 保全性

- **データが残せること**
  - 発行履歴・デザインデータが適切に保存され、必要時に参照できること。

#### 2-4. 運用ルール（必須）

- **注文時にデザインID必須**
  - デザインIDなしの注文は、運用上成立しない前提とする。

---

### 3. システム概要

- **用途**  
  名入れ・刻印のロゴ配置を、ブラウザ上で作成し、デザインIDとして確定させ、注文時に共有・検索・刻印につなげるためのツール。

- **登場人物**
  - **運用担当者**：基本設定、テンプレート登録、公開URL共有、発行履歴（デザインID）検索・確認、刻印作業に利用。
  - **お客様**：公開URLからロゴ配置を作成し、デザインIDを発行して注文時に貼り付け。

---

### 4. 技術スタック

- **フロントエンド**
  - 言語：TypeScript
  - フレームワーク：React
  - ビルドツール：Vite
  - スタイル：Tailwind CSS + 独自CSS（`guide-style.css` など）

- **データ保存**
  - `localStorage`：テンプレート情報、発行済みデザイン情報（デザインID含む）、基本設定・カテゴリ設定などのテキスト系
  - `IndexedDB (ksim_db)`：背景画像、ロゴ画像、生成PDF、バックアップ等のバイナリ

- **その他**
  - PDF生成：`src/domain/pdf`
  - テスト：Vitest / Playwright
  - デプロイ：GitHub Pages / Node.js / Docker / Nginx（`DEPLOY.md` 参照）

---

### 5. 画面とデータの流れ（ざっくり）

#### 5-1. 運用担当者の流れ

1. **基本設定（/admin/common）**
   - ロゴ、サイトタイトル、共通説明、カテゴリ名・色などを入力。
   - 保存した設定は、公開テンプレート一覧や案内ページ等に反映される。

2. **テンプレート管理（/admin/templates）**
   - `template.json` と背景画像を登録し、配置範囲・キャンバスサイズ等を設定。
   - 状態（`draft` / `tested` / `published` / `archived`）で管理。
   - `published` のテンプレートが公開URLの対象となる。

3. **公開テンプレート一覧／カテゴリ一覧（/top, /categories）**
   - 公開状態とURLを一覧で確認し、コピー・共有するための画面。

4. **発行履歴（/admin/designs）**
   - お客様がデザインIDを発行すると、発行履歴にデータが残る。
   - 注文時に受け取ったデザインIDで検索し、該当デザインを参照して刻印作業に利用する。

#### 5-2. お客様の流れ

1. 共有された公開URL（`/sim/:templateKey`）を開く。
2. 共通説明を読み、注意事項に同意して進む。
3. デザインシミュレーターでロゴ配置（位置・大きさ）を作成する。
4. デザインIDを発行し、確認用PDFを発行してダウンロードする。
5. デザインIDを注文ページに貼り付けて注文する。

---

### 6. お客様→運用担当者の運用フロー（注文〜刻印）

#### 6-1. お客様側（注文まで）

1. 注文ページからデザインシミュレーターのリンクに移動。
2. 共通説明を読む。
3. 注意事項に同意してクリック。
4. デザイン作成（ロゴ位置・大きさ設定）。
5. デザインID発行 ＆ 確認用PDF発行。
6. デザインIDを注文ページに貼り付け（必須）。

#### 6-2. 運用担当者側（刻印作業）

1. 注文情報からデザインIDを確認。
2. 管理画面でデザインID検索し、発行履歴から該当デザインを特定。
3. 該当デザインデータを基に刻印作業を実施。

---

### 7. データ（参考：保存の役割）

#### 7-1. localStorage

- テンプレート一覧・各テンプレート設定
- 発行履歴（デザインID、発行日時、テンプレート、配置情報など）
- 基本設定（ロゴ、サイトタイトル、共通説明、カテゴリ情報など）

#### 7-2. IndexedDB（ksim_db）

- 背景画像、ロゴ画像（元／加工後）、確認用PDF、バックアップデータ
- Safari等への配慮として、BlobをDataURLに変換して保存する分岐あり（`src/storage/idb.ts`）。

---

### 8. 運用上の留意点（現時点）

※「問題点」というより、運用時に詰まりやすい箇所の整理です。

#### 8-1. テスト運用と本番運用の切り替え

- 現在はGitHubでテスト運用中。
- 本番運用に向けてHP側の保存先設定を進行中。
- 切り替え時は、公開URLや保存先挙動に影響が出る可能性があるため、運用手順（共有方法・確認方法）の固定が必要。

#### 8-2. GitHub Pages / SPA ルーティング周り

- SPAのため、`/admin/*` や `/common?hideNav=1` 等で 404 になり得る。
- `404.html` を使ったルーティング調整、`import.meta.env.BASE_URL` を意識したURL生成が必要。
- GitHub Actionsのエラーは、再発防止のために要点をドキュメントへ蓄積する。

#### 8-3. ローカル開発環境の差異

- Node.js / pnpm状況により、`vite` が見つからない／ポート衝突で起動しない等が起こり得る。
- Windows用バッチ／PowerShellで依存確認・ポート衝突確認を支援しているが、日本語パスやOneDrive連携で警告が出る場合がある。

#### 8-4. UI/UX（運用しながら改善する領域）

- 文言の簡素化、画面の役割分離の強調、ツールチップ整備は継続改善。
- 「お客様が迷わずデザインIDを発行し、注文ページへ貼れる」導線は特に重要。

---

### 9. 今後の拡張アイデア（メモ）

- サーバー側に履歴を集約するモード（マルチ端末で履歴共有）
- テンプレート／履歴のロールバック（簡易バージョン管理）
- 複数店舗・複数ブランドを扱う「テナント」概念
- 操作ログ整備（監査用途）

---

### 10. 参照（読めば全体が分かるファイル）

- `README.md`：概要／画面構成／起動
- `SPEC.md`：詳細仕様
- `public/overall_flow.html`：全体フロー
- `src/storage/local.ts`：localStorage
- `src/storage/idb.ts`：IndexedDB
- `src/storage/backup.ts`：バックアップ／復元

## 名入れ刻印シミュレーター ミーティング報告書

### 0. 現状のざっくりまとめ（いま何ができるか）

- **管理する人（社内側）ができること**
  - 基本設定（ロゴ・見出し・共通説明・カテゴリ色など）を登録・変更できる
  - テンプレート（JSON＋背景画像）を登録し、下書き→テスト→公開まで状態管理できる
  - 公開用URLを発行し、お客様に共有できる
  - 発行履歴を検索・確認・削除したり、バックアップ/復元ができる
- **お客様（外部の利用者）ができること**
  - 管理者から渡された公開URLを開き、ロゴ等を入れてPDFを発行できる
  - 発行したPDFをダウンロードして、印刷や共有に使える
- **データの保存方法（現状）**
  - サーバーDBは使わず、ブラウザ内の `localStorage` / `IndexedDB` に保存している
  - 端末やブラウザが変わると、履歴などは共有されない（= ローカル完結型）

---

### 0-1. 最終的に実現したいこと（ゴールのイメージ）

- **自分たちの現場で、迷わず・安心して使える名入れシミュレーターにする**
  - テンプレ登録〜ロゴ配置〜PDF発行〜履歴確認までを、ブラウザだけで安定運用できる。
  - トラブル時も、自分たちだけで原因を追い、バックアップ/復元しながら継続利用できる。
- **社内メンバーや外注先にも、そのまま渡せる共通ツールにする**
  - 管理画面とお客様画面の役割がガイドとUIでハッキリ分かる。
  - ロゴ・カラー・文言などはブランド/案件ごとに簡単に切り替えられる（基本設定で対応）。
  - 必要に応じて、パスワードや保存ルールを決めて、外注先にも安全に開放できる。
- **クライアントごとに“ブランド合わせ”したパッケージとして提供できるようにする**
  - 仕組みは共通＋見た目と文言だけ各社仕様にして、短時間で導入・展開できる。
  - フォントやカラーも、将来的にはテーマ/プリセットとして切り替えやすくする。
- **出力データの役割分担を整理し、PDFとAIを使い分けられるようにする**
  - システムはまず PDF出力を確実にこなす“自動生成エンジン”として使う。
  - PDFで済む案件はそのまま運用し、AIが必要な案件は「デザイナー・外注側でAI化（Illustrator作業）」という線引きを前提にする。
- **将来的には「名入れ/刻印シミュレーターサービス」として再利用・展開できる土台にする**
  - まず自社用・外注先用として使い込み、その経験をもとに、必要なところだけカスタマイズして他社にも提供できる汎用パッケージ的なポジションを目指す。

---

### 1. システム概要

- **用途**: 名入れ・刻印付きの証書などを、ブラウザ上でレイアウト確認しながらPDF発行するための社内向けツール
- **主な登場人物**
  - **管理する人（社内・運用担当）**: 基本設定、テンプレート登録、公開URLの発行、発行履歴の確認・整理を行う
  - **お客様（利用者）**: 管理者から渡された公開URLだけを使って、ロゴ等を入れ、PDFを発行する
- **サーバーDBは使わない設計**
  - データはすべて、利用しているブラウザの `localStorage` / `IndexedDB` に保存
  - そのため「どの端末・どのブラウザで操作したか」で見えるデータが変わる

---

### 2. 技術スタック

- **フロントエンド**
  - 言語: TypeScript
  - フレームワーク: React
  - ビルドツール: Vite
  - スタイル: Tailwind CSS + 独自CSS（`guide-style.css` など）
- **データ保存**
  - `localStorage`: テンプレート情報、発行済みデザイン情報、基本設定・カテゴリ設定などの「テキスト系」データ
  - `IndexedDB (ksim_db)`: 背景画像、ロゴ画像、生成したPDF、バックアップデータなどの「バイナリ（大きめのファイル）」データ
- **その他**
  - PDF生成: `src/domain/pdf` 以下のロジックで、テンプレート設定＋画像＋ロゴから確認用／刻印用PDFを生成
  - テスト: Vitest / Playwright
  - デプロイ: GitHub Pages / Node.js サーバー / Docker / Nginx（`DEPLOY.md` 参照）

---

### 3. 画面とデータの流れ（ざっくり）

#### 3-1. 管理者側の流れ

1. **基本設定（/admin/common）**
   - ロゴ、サイトタイトル、共通説明、カテゴリ名・色などを入力
   - 保存すると、`localStorage` に「共通設定」として保存される
   - 公開テンプレ一覧（`/top`）、カテゴリ一覧（`/categories`）、シミュレーター画面のヘッダーなどに反映される

2. **テンプレート管理（/admin/templates）**
   - `template.json` と背景画像をアップロードし、「どこにロゴを置けるか」「キャンバスの大きさ」などを設定
   - 登録されたテンプレート情報は `localStorage` に、背景画像は `IndexedDB` に保存
   - ステータス（`draft` / `tested` / `published` / `archived`）を切り替えながら品質確認
   - `published` のテンプレートだけが「公開用URL」としてお客様用の入口になる

3. **公開テンプレ一覧 / カテゴリ一覧（/top, /categories）**
   - **社内向けの確認用画面**
   - どのテンプレートが公開状態か、カテゴリごとのURLは何かを一覧で確認
   - 「コピー」「開く」ボタンから公開URLを用意し、お客様や社内メンバーへ共有する
   - お客様は通常、この画面そのものは見えない（URLだけを使う）

4. **デザイン履歴（/admin/designs）**
   - お客様がシミュレーターからPDFを発行すると、「デザインID＋テンプレート＋日時＋各種設定」が `localStorage` に保存される
   - PDF・ロゴ画像などの重いデータは `IndexedDB` に保存
   - 画面上では、検索・削除・（実装済み範囲での）バックアップ／復元などを操作

#### 3-2. お客様側の流れ

1. 管理者から渡された **公開URL（例: `/sim/:templateKey`）** を開く
2. シミュレーター画面でロゴをアップロードし、位置・大きさ・色調整などを行う
3. 確認用／刻印用PDFを発行し、ブラウザからダウンロードして保存・印刷・共有する

> ポイント: お客様は「公開URL」と「PDF」だけを見ます。  
> 基本設定／テンプレート管理／公開テンプレ一覧／カテゴリ一覧／デザイン履歴はすべて管理者専用画面です。

---

### 4. データベース（実際はブラウザ保存）の役割

#### 4-1. localStorage

- 保存するもの（例）
  - テンプレート一覧・各テンプレートの設定（キー、タイトル、背景ファイル名、刻印範囲など）
  - 発行履歴（デザインID、いつ発行したか、どのテンプレートか、配置情報など）
  - 共通設定（ロゴ・サイトタイトル・共通説明・カテゴリ情報 など）
- 特徴
  - 軽量なテキストデータ中心
  - ブラウザごとに保存される（同じPCでも、ブラウザが違うと別データ）

#### 4-2. IndexedDB

- 保存するもの（例）
  - 背景画像ファイル（テンプレート用）
  - お客様がアップロードしたロゴ画像（元画像と加工後の両方）
  - 生成したPDF（確認用・刻印用）
  - バックアップデータ（エクスポート／インポートに使う）
- 特徴
  - 比較的大きなファイルも扱える
  - 履歴画面やプレビューで、必要なときに都度読み出して使う

---

### 5. 既知の問題点・課題

#### 5-1. ブラウザ依存・端末依存

- サーバーDBを使わず、ブラウザ内に保存しているため:
  - 端末やブラウザが変わると、**同じ「お客様」でも履歴が共有されない**
  - ブラウザのストレージを削除すると、履歴やテンプレートも消える
- 対策・案
  - 定期的なバックアップ（エクスポート）運用を前提にする
  - 将来的に、サーバー側DBを持つ構成への拡張も検討余地あり

#### 5-2. GitHub Pages / SPA ルーティングまわり

- GitHub Pages への自動デプロイ時に、以下のような課題が発生しやすい:
  - `404.html` を使った SPA ルーティングの調整が必要
  - `deploy.yml` のシェルスクリプト（特に `here-document` 相当部分）の書き方によっては YAML エラーになることがある
  - `/common?hideNav=1` のようなクエリ付きURLや、`/admin/*` などのSPAルートで 404 になるケース
- 対策・案
  - `deploy.yml` のスクリプト部分をできるだけシンプルに保つ
  - ルーティングは `import.meta.env.BASE_URL` を意識して生成し、公開URLとローカルURLがずれないようにする
  - GitHub Actions のエラー内容を README や専用ドキュメントに蓄積しておく

#### 5-3. ローカル開発環境のつまずきポイント

- Node.js / pnpm のインストール状況によっては:
  - `vite` コマンドが見つからない
  - 既存ポート（例: 5174）が使用中で起動できない
- 現状の対策
  - Windows 用バッチ／PowerShell スクリプトで「依存関係の有無チェック」「ポートの衝突チェック」「ブラウザ自動オープン」などをサポート
  - ただし、ユーザー環境ごとの差異（日本語パス、OneDrive 連携など）で PowerShell の警告が出ることがある

#### 5-4. UI/UX 上の細かい改善余地

- 管理画面・ガイド文は徐々に改善されているが、今後も:
  - 文言のわかりやすさ（専門用語の削減）
  - 「お客様が見る画面」と「管理者だけの画面」の区別の強調
  - 初めて触る人向けのチュートリアル・ツールチップの充実
 など、運用状況を見ながら継続的な微調整が必要。

---

### 6. 今後の拡張アイデア（メモ）

- サーバー側に履歴を集約するモード（マルチ端末で履歴共有）
- テンプレート／履歴のロールバック機能（簡易バージョン管理）
- 複数店舗・複数ブランドをまとめて扱う「テナント」的な概念の追加
- 主要操作（公開URL発行・PDF出力など）に対する操作ログの整理（監査用）

# 名入れ刻印シミュレーター - 仕様/運用サマリー

## 1. 概要（何ができるか）
社内向けの名入れ刻印シミュレーターです。テンプレートの登録、ロゴの配置、PDF（確認用/刻印用）発行、発行履歴の管理までをブラウザで完結できます。

特徴:
- サーバーDBを前提にしない（永続化はブラウザの `localStorage` と `IndexedDB`）。
- 管理者がテンプレートを公開してURLを発行し、お客様はそのURL（`/sim/:templateKey`）だけを開いて利用する運用が基本。
- バックアップ/復元（自動バックアップ + 手動エクスポート）によりデータを保全できる。

## 2. 役割とユーザーの動き（ステップ別・現状）

### 2.1 管理者（社内・運用者）の操作フロー
1) 基本設定（共通情報）を登録: `/admin/common`
- ロゴ、見出し、共通説明、カテゴリカラーなど「全体に効く設定」を整備。

2) テンプレートを登録・調整: `/admin/templates`
- JSON + 背景画像を登録し、プレビューで配置/表示を確認。
- 状態は概ね `draft -> tested -> published` の順で切替。

3) 公開URLを発行して共有
- テンプレートを公開し、生成された公開URLをお客様へ共有。
- `/top` や `/categories` は社内の公開状況確認・共有補助として使う（お客様が必ず見る前提ではない）。

4) 発行履歴の確認/対応: `/admin/designs`
- 検索、絞り込み、削除、必要に応じてバックアップ/復元を実施。

### 2.2 お客様（利用者）の操作フロー
1) 管理者から渡された公開URLを開く: `/sim/:templateKey`
- 公開テンプレート一覧を見ずに、URL直アクセスで利用する運用が基本。

2) ロゴ等を投入して仕上がりを確認
- ロゴアップロード、配置調整など。

3) PDFを発行して保存
- 確認用/刻印用PDFを生成しダウンロード。

## 3. 画面（ルーティング）
- `/top`: 公開テンプレート一覧（社内の確認/共有補助として使うことが多い）
- `/categories`: カテゴリ別 公開URL 一覧（社内の確認/共有補助として使うことが多い）
- `/sim/:templateKey`: シミュレーター本体（お客様が主に利用）
- `/admin/common`: 基本設定/共通説明
- `/admin/templates`: テンプレート管理
- `/admin/designs`: 発行履歴管理
- `/common`: 共通説明ページ（お客様向け）

## 4. 技術スタック
- フロントエンド: React / Vite / Tailwind CSS
- サーバー: Node.js / Express（`server.js`）
- PDF/画像: `pdf-lib`, `@napi-rs/canvas`, `pdfjs-dist`
- テスト: Vitest（unit）, Playwright（E2E）

## 5. データの流れ（アーキテクチャ）

### 5.1 設定・テンプレート登録 -> 公開
- 管理者が `/admin/common` で共通設定を登録。
- 管理者が `/admin/templates` でテンプレート（JSON/背景）を登録し、公開状態へ切替。

### 5.2 お客様の利用 -> PDF生成
- お客様は `/sim/:templateKey` を開き、ロゴなどを入力してPDFを生成。
- 生成されたPDFはブラウザ側に保存され、必要に応じてダウンロード。

### 5.3 履歴確認
- 管理者が `/admin/designs` で発行履歴を閲覧/検索/削除。

## 6. 永続化（ブラウザ保存 = "データベース"）

### 6.1 localStorage
- プレフィックス `ksim:` のキーでデータを保持。
- 用途: テンプレート/デザイン/共通設定のメタ情報（JSON文字列）。
- 実装: `src/storage/local.ts`

### 6.2 IndexedDB: `ksim_db`
- Object Store:
  - `assets`: 画像/PDFなどのバイナリ（Blob）
  - `backups`: バックアップJSON（文字列）
- 実装: `src/storage/idb.ts`
- AssetType（例）: `templateBg`, `logoOriginal`, `logoEdited`, `pdfConfirm`, `pdfEngrave`

補足:
- WebKit系（Safari等）対策として、BlobをDataURLに変換して保存する分岐がある（`src/storage/idb.ts`）。

## 7. バックアップ/復元
- 自動バックアップID: `auto-latest`
- 対象:
  - `localStorage` の `ksim:` キー
  - `assets`（BlobをDataURLに変換して同梱）
- 実装: `src/storage/backup.ts`

## 8. 既知の問題点/課題（要注意）

### 8.1 Node.js バージョン
- `package.json` の `engines` は `>=20 <23`。
- Node 24 などでも動く場合がありますが、`npm install` で `EBADENGINE` 警告が出る可能性があります。
- 対応方針: 本番/開発をNode 20/22に統一するか、対応するなら `engines` を更新する。

### 8.2 端末/ブラウザ依存（重要）
- データはサーバーDBではなくブラウザの `localStorage` / `IndexedDB` に保存されます。
- 端末やブラウザが変わると、履歴・設定・テンプレートが見えない/別物になります。
- 対応方針: 運用ルール（使用端末の固定、定期バックアップ、復元手順）を明文化する。

### 8.3 容量・互換性
- 画像/PDFを溜め込むと IndexedDB の容量制限に当たる可能性があります。
- Safari等はIndexedDBの挙動差があり、DataURL保存分岐で回避しているが、容量増のリスクがある。

### 8.4 文書の重複/更新負荷
- README / ガイドHTML / BUILD/DEPLOY ドキュメントが分散しやすい。
- 対応方針: READMEは概要と導線に寄せ、詳細は `docs/` と `public/` のガイドに集約する。

## 9. 参照（読めば全体が分かるファイル）
- `README.md`: 入口の概要/画面構成/起動
- `SPEC.md`: 画面と仕様の詳細
- `public/overall_flow.html`: 管理者/お客様の全体フローガイド
- `src/storage/local.ts`: localStorage
- `src/storage/idb.ts`: IndexedDB `ksim_db`
- `src/storage/backup.ts`: バックアップ/復元

