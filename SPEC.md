# 仕様メモ（カテゴリ一覧・カラー対応を含む現行仕様）

## 目的
お客様向け公開ページと管理機能で、カテゴリごとにテンプレートを探しやすくし、カテゴリ別のブランドカラーを反映できるようにする。

## 画面 / ルーティング
- `/top` 公開テンプレート一覧（お客様入口）
- `/sim/:templateKey` シミュレーター本体
- `/categories` カテゴリ別公開URL一覧（お客様向け、カテゴリごとに表を分割）
- `/common` 共通説明ページ
- `/admin/templates` テンプレート管理
- `/admin/designs` 発行履歴管理
- `/admin/common` 共通設定（カテゴリマスター含む）

## データ構造
- `CommonSettings.commonInfoCategories`: `{ id: string, title: string, body?: string, color?: string }`
  - 最大 3 件まで（定数 `MAX_CATEGORIES = 3`）。
  - `color` 省略時はグレー系で表示。

## カテゴリカラー（基本設定）
- 5 色プリセット（`CATEGORY_COLORS`）から選択。
- 新規カテゴリ追加時にプリセット色を自動割当。
- 既存データに `color` がない場合は従来色で表示。

## 公開テンプレート一覧 `/top`
- 表示対象: `status === "published"` のみ。
- front/back 付きキーはベースキーでまとめ、表面を優先（なければ裏→そのほか）。
- 名前: 表裏ペアがある場合は「○○（表/裏）」。
- カテゴリバッジ: 頭文字 1 文字＋カテゴリカラー（未指定はグレー）。未設定カテゴリは「未分類」扱い。
- フィルタ: 検索テキスト、カテゴリチェックボックス。`?cat=` クエリで初期カテゴリ選択可（複数可）。
- URL列: カテゴリごとに公開URLをコピーできるボタン（`/sim/{key}?cat={カテゴリID}`）。

## カテゴリ一覧 `/categories`
- カテゴリごとにテーブルを分割表示。
- 行: テンプレート名 / 公開URL / 操作（コピー・開く）。
- 公開URLは `/sim/{templateKey}?cat={カテゴリID}`。front/back は表面優先で生成。
- 表示対象: 公開中テンプレのみ。各カテゴリ内で名前順ソート。

## 基本設定でのカテゴリ管理
- 入力項目: ID（自動生成）、タイトル、本文（任意）、カラー（5 色プリセット）。
- ボタン: 追加（最大 3 件）、削除。
- カラーはプリセットチップをクリックして選択。保存すると公開一覧・カテゴリ一覧のバッジ色に反映。

## 制限・注意
- カテゴリ数は 3 まで。
- カラーは 5 色固定（配列変更で拡張可）。
- `color` 未指定の既存データはそのまま利用可能（グレー表示）。
- データ保存先: localStorage（設定・テンプレ・デザイン）、IndexedDB（画像・PDF・バックアップ）。

## フロント/バック扱い
- `_front` / `_back` キーは同一ベースキーでまとめ、表を優先して公開URLを生成。片面のみ登録されている場合はその面を使用。

## 今後の拡張候補
- 管理側一覧にもカテゴリカラーを表示するバッジを追加。
- カラープリセットのカスタム（ユーザー定義パレット）対応。
